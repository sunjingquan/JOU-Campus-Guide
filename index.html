<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>江苏海洋大学新生入学指南 (校区选择版)</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tailwind CSS 配置 -->
    <script>
      // 明确告诉Tailwind使用 'class' 策略进行深色模式切换
      tailwind.config = {
        darkMode: 'class',
      }
    </script>
    <!-- 引入Lucide图标库 -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- 引入Inter字体 -->
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <style>
        /* 自定义样式区 */
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
        }
        /* 美化滚动条 */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        html.dark ::-webkit-scrollbar-track { background: #1f2937; }
        html.dark ::-webkit-scrollbar-thumb { background: #4b5563; }
        html.dark ::-webkit-scrollbar-thumb:hover { background: #6b7280; }

        /* 激活的导航链接 */
        .sidebar-link.active {
            background-color: #1e40af;
            color: white;
            font-weight: 600;
        }
        html.dark .sidebar-link.active {
            background-color: #3b82f6;
        }
        
        /* 主页大图背景 */
        .hero-bg {
            background-image: linear-gradient(to right, rgba(30, 58, 138, 0.8), rgba(67, 56, 202, 0.7)), url('https://placehold.co/1200x600/e0e7ff/3730a3?text=JOU+Campus');
            background-size: cover;
            background-position: center;
        }

        /* 内容区块 */
        .content-section {
            padding-top: 4rem;
            padding-bottom: 4rem;
            border-bottom: 1px dashed #e2e8f0;
        }
        html.dark .content-section {
            border-bottom-color: #374151;
        }
        .content-section:last-child {
            border-bottom: none;
        }

        /* 可折叠导航菜单 */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, opacity 0.3s ease-in-out;
            opacity: 0;
        }
        .submenu.open {
            max-height: 1000px;
            opacity: 1;
        }
        .category-header .accordion-icon {
            transition: transform 0.3s ease-in-out;
        }
        .category-header.open .accordion-icon {
            transform: rotate(180deg);
        }
        
        /* 视图过渡效果 */
        #detail-view, #search-view {
            transition: transform 0.3s ease-in-out;
        }

        /* 搜索结果高亮 */
        .search-highlight {
            background-color: #fef9c3; /* yellow-100 */
            color: #713f12; /* amber-800 */
            border-radius: 3px;
        }
        
        /* 临时高亮动画 */
        @keyframes highlight-fade {
            from { background-color: #fde047; } /* yellow-400 */
            to { background-color: transparent; }
        }
        .temp-highlight {
            animation: highlight-fade 2s ease-in-out;
        }

        /* 加载动画 */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        html.dark .loader {
            border-color: #4b5563;
            border-top-color: #3b82f6;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="overflow-hidden">
    <!-- 加载动画 -->
    <div id="loading-overlay" class="fixed inset-0 bg-white dark:bg-gray-950 z-50 flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="loader"></div>
        <p class="mt-4 text-lg font-semibold text-gray-700 dark:text-gray-300">江苏海洋大学校园指南</p>
        <p class="text-sm text-gray-500">正在加载...</p>
    </div>

    <!-- 校区选择器模态窗口 -->
    <div id="campus-selector-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-3xl transform transition-all scale-95 opacity-0 flex flex-col max-h-full" id="campus-selector-dialog">
            <div class="p-6 md:p-8 text-center flex-shrink-0">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2">欢迎来到江苏海洋大学！</h2>
                <p class="text-gray-600 dark:text-gray-400">请选择你的校区，以便我们为你提供更精准的指南。</p>
            </div>
            <div class="overflow-y-auto px-6 md:px-8 pb-6 md:pb-8">
                <div class="space-y-4 md:space-y-0 md:grid md:grid-cols-3 md:gap-6">
                    <!-- 苍梧校区卡片 -->
                    <button data-campus="cangwu" class="campus-select-btn w-full text-left rounded-xl shadow-lg group transform hover:scale-105 transition-transform duration-300 overflow-hidden bg-gray-100 dark:bg-gray-800">
                        <div class="md:hidden flex items-center p-2">
                            <div class="w-24 h-16 rounded-lg bg-gray-200 dark:bg-gray-700 flex-shrink-0">
                                <img src="images/苍梧校区.jpg?nf_resize=fit&w=200" alt="[苍梧校区的图片]" class="w-full h-full object-contain">
                            </div>
                            <div class="ml-4">
                                <h3 class="text-gray-800 dark:text-gray-100 text-lg font-bold">苍梧校区</h3>
                            </div>
                        </div>
                        <div class="hidden md:block relative h-56">
                            <img src="images/苍梧校区.jpg?nf_resize=fit&w=800&fm=webp" alt="[苍梧校区的图片]" class="absolute inset-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-4">
                                <h3 class="text-white text-2xl font-bold drop-shadow-lg">苍梧校区</h3>
                            </div>
                        </div>
                    </button>
                    <!-- 通灌校区卡片 -->
                     <button data-campus="tongguan" class="campus-select-btn w-full text-left rounded-xl shadow-lg group transform hover:scale-105 transition-transform duration-300 overflow-hidden bg-gray-100 dark:bg-gray-800">
                        <div class="flex items-center p-2 md:hidden">
                           <div class="w-24 h-16 rounded-lg bg-gray-200 dark:bg-gray-700 flex-shrink-0">
                                <img src="images/通灌校区.jpg?nf_resize=fit&w=200" alt="[通灌校区的图片]" class="w-full h-full object-contain">
                            </div>
                            <div class="ml-4">
                                <h3 class="text-gray-800 dark:text-gray-100 text-lg font-bold">通灌校区</h3>
                            </div>
                        </div>
                        <div class="hidden md:block relative h-56">
                            <img src="images/通灌校区.jpg?nf_resize=fit&w=800&fm=webp" alt="[通灌校区的图片]" class="absolute inset-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-4">
                                <h3 class="text-white text-2xl font-bold drop-shadow-lg">通灌校区</h3>
                            </div>
                        </div>
                    </button>
                    <!-- 宋跳校区卡片 -->
                    <button data-campus="songtiao" class="campus-select-btn w-full text-left rounded-xl shadow-lg group transform hover:scale-105 transition-transform duration-300 overflow-hidden bg-gray-100 dark:bg-gray-800">
                        <div class="flex items-center p-2 md:hidden">
                            <div class="w-24 h-16 rounded-lg bg-gray-200 dark:bg-gray-700 flex-shrink-0">
                                <img src="images/宋跳校区.jpg?nf_resize=fit&w=200" alt="[宋跳校区的图片]" class="w-full h-full object-contain">
                            </div>
                            <div class="ml-4">
                                <h3 class="text-gray-800 dark:text-gray-100 text-lg font-bold">宋跳校区</h3>
                            </div>
                        </div>
                        <div class="hidden md:block relative h-56">
                            <img src="images/宋跳校区.jpg?nf_resize=fit&w=800&fm=webp" alt="[宋跳校区的图片]" class="absolute inset-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 p-4">
                                <h3 class="text-white text-2xl font-bold drop-shadow-lg">宋跳校区</h3>
                            </div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 主视图 -->
    <div id="main-view" class="flex h-screen relative">
        <!-- 移动端遮罩层 -->
        <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>

        <!-- 侧边栏导航 -->
        <aside id="sidebar" class="w-72 bg-blue-900 dark:bg-gray-900 text-white p-5 overflow-y-auto transition-transform transform -translate-x-full md:translate-x-0 fixed md:relative h-full z-30 shadow-lg flex flex-col">
            <div class="text-center mb-10">
                <h1 class="text-3xl font-bold tracking-wider">江苏海洋大学</h1>
                <p class="text-sm text-blue-200 dark:text-gray-400 mt-1">校园指南</p>
            </div>
            <nav id="nav-menu" class="flex-grow"></nav>
            <!-- 底部工具栏 -->
            <div class="mt-auto pt-4 border-t border-blue-800 dark:border-gray-700 space-y-2">
                <button id="feedback-btn" class="w-full flex items-center justify-center px-4 py-2 text-sm text-blue-200 dark:text-gray-300 rounded-md hover:bg-blue-800 dark:hover:bg-gray-700 transition-colors">
                    <i data-lucide="message-square-plus" class="w-4 h-4 mr-2"></i>
                    <span>信息反馈</span>
                </button>
                <button id="theme-toggle-btn" class="w-full flex items-center justify-center px-4 py-2 text-sm text-blue-200 dark:text-gray-300 rounded-md hover:bg-blue-800 dark:hover:bg-gray-700 transition-colors">
                    <span id="theme-icon-sun" class="mr-2">
                        <i data-lucide="sun" class="w-4 h-4"></i>
                    </span>
                    <span id="theme-icon-moon" class="mr-2 hidden">
                        <i data-lucide="moon" class="w-4 h-4"></i>
                    </span>
                    <span id="theme-text">切换模式</span>
                </button>
                 <button id="change-campus-btn" class="w-full flex items-center justify-center px-4 py-2 text-sm text-blue-200 dark:text-gray-300 rounded-md hover:bg-blue-800 dark:hover:bg-gray-700 transition-colors">
                    <i data-lucide="map-pin" class="w-4 h-4 mr-2"></i>
                    <span id="current-campus-display"></span>
                </button>
            </div>
        </aside>

        <!-- 主内容区域 -->
        <main class="flex-1 flex flex-col h-screen">
            <header class="bg-white dark:bg-gray-900 dark:border-b dark:border-gray-800 shadow-md p-3 flex justify-between items-center z-10 space-x-4">
                <button id="menu-toggle" class="md:hidden text-gray-700 dark:text-gray-300 flex-shrink-0"><i data-lucide="menu"></i></button>
                <h2 id="content-title" class="text-xl font-semibold text-gray-800 dark:text-gray-100 truncate hidden sm:block"></h2>
                <form id="search-form" class="relative w-full max-w-xs ml-auto">
                    <input type="search" id="search-input" placeholder="搜索指南..." class="w-full pl-10 pr-4 py-2 rounded-full border bg-gray-100 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 focus:bg-white dark:focus:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                </form>
                <a href="#" id="home-button-top" class="text-gray-600 dark:text-gray-400 hover:text-blue-700 dark:hover:text-blue-400 transition-colors flex-shrink-0"><i data-lucide="home" class="w-5 h-5"></i></a>
            </header>
            <div id="content-area" class="flex-1 px-4 md:px-8 overflow-y-auto bg-gray-50 dark:bg-gray-950">
                <!-- 内容将通过JS动态加载到这里 -->
            </div>
        </main>
    </div>

    <!-- 详情视图 -->
    <div id="detail-view" class="fixed inset-0 bg-gray-50 dark:bg-gray-950 z-40 flex-col transform translate-x-full hidden">
        <header class="bg-white dark:bg-gray-900 dark:border-b dark:border-gray-800 shadow-md p-4 flex items-center z-10 flex-shrink-0">
            <button id="back-to-main-btn" class="text-gray-600 dark:text-gray-300 hover:text-blue-700 dark:hover:text-blue-400 transition-colors">
                <i data-lucide="chevron-left" class="w-6 h-6"></i>
            </button>
            <h2 id="detail-title" class="text-xl font-semibold text-gray-800 dark:text-gray-100 truncate ml-4">详情</h2>
        </header>
        <div id="detail-content" class="flex-1 p-4 md:p-8 overflow-y-auto">
            <!-- 详细内容将加载到这里 -->
        </div>
    </div>

    <!-- 搜索结果视图 -->
    <div id="search-view" class="fixed inset-0 bg-gray-50 dark:bg-gray-950 z-40 flex-col transform translate-x-full hidden">
        <header class="bg-white dark:bg-gray-900 dark:border-b dark:border-gray-800 shadow-md p-4 flex items-center z-10 flex-shrink-0">
            <button id="back-to-main-from-search-btn" class="text-gray-600 dark:text-gray-300 hover:text-blue-700 dark:hover:text-blue-400 transition-colors">
                <i data-lucide="chevron-left" class="w-6 h-6"></i>
            </button>
            <h2 id="search-title" class="text-xl font-semibold text-gray-800 dark:text-gray-100 truncate ml-4">搜索结果</h2>
        </header>
        <div id="search-results-container" class="flex-1 p-4 md:p-8 overflow-y-auto">
            <!-- 搜索结果将加载到这里 -->
        </div>
    </div>

    <!-- 反馈模态窗口 -->
    <div id="feedback-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 hidden">
        <div id="feedback-dialog" class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md p-6 transform transition-all scale-95 opacity-0">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100">信息反馈</h3>
                <button id="close-feedback-btn" class="text-gray-500 hover:text-gray-800 dark:hover:text-gray-200">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <form id="feedback-form" name="feedback" data-netlify="true">
                <div class="space-y-4">
                    <div>
                        <label for="feedback-content" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">反馈内容</label>
                        <textarea id="feedback-content" name="content" rows="4" required class="w-full p-2 border rounded-md bg-gray-50 dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="请详细描述您发现的问题或建议..."></textarea>
                    </div>
                    <div>
                        <label for="feedback-contact" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">联系方式 (可选)</label>
                        <input type="text" id="feedback-contact" name="contact" class="w-full p-2 border rounded-md bg-gray-50 dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="QQ / 微信 / 邮箱">
                    </div>
                </div>
                <div class="mt-6 text-right">
                    <button type="submit" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">提交</button>
                </div>
            </form>
            <div id="feedback-success-msg" class="hidden text-center py-8">
                <i data-lucide="check-circle" class="w-16 h-16 text-green-500 mx-auto mb-4"></i>
                <p class="text-lg font-semibold text-gray-800 dark:text-gray-100">感谢您的反馈！</p>
                <p class="text-sm text-gray-500 dark:text-gray-400">我们会尽快处理。</p>
            </div>
        </div>
    </div>


    <script>
        // ===================================================================================
        // --- 数据中心 (Data Center) ---
        // ===================================================================================
        const guideData = {
            "主页": {
                icon: "home",
                isHomePage: true,
                pages: { "home": { title: "欢迎来到江苏海洋大学", content: `
                                        <div class="flex flex-col justify-center items-center h-full">
                                            <div class="hero-bg text-white p-12 rounded-2xl text-center flex flex-col items-center justify-center shadow-xl mb-12">
                                                <h1 class="text-5xl font-extrabold mb-4 drop-shadow-lg">开启你的大学新篇章</h1>
                                                <p class="text-lg max-w-2xl mb-8 drop-shadow-md">本指南将帮助你快速熟悉校园生活，解决入学遇到的各种问题。准备好了吗？</p>
                                                <button id="explore-btn" class="bg-white text-blue-800 font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-100 transform hover:scale-105 transition-all duration-300 shadow-lg">开始探索</button>
                                            </div>
                                            <div>
                                                <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mb-8 text-center">快速导航</h2>
                                                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                                                    <a href="#" data-navlink='{"category": "入学准备", "page": "新生入学流程"}' class="nav-card bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md hover:shadow-2xl dark:hover:shadow-blue-500/20 hover:-translate-y-2 transition-all duration-300 flex flex-col items-center text-center">
                                                        <div class="bg-blue-100 text-blue-600 p-4 rounded-full mb-4"><i data-lucide="list-checks" class="w-8 h-8"></i></div>
                                                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">入学流程</h3>
                                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">报到注册步骤全解析</p>
                                                    </a>
                                                    <a href="#" data-navlink='{"category": "校园生活", "page": "宿舍介绍"}' class="nav-card bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md hover:shadow-2xl dark:hover:shadow-green-500/20 hover:-translate-y-2 transition-all duration-300 flex flex-col items-center text-center">
                                                        <div class="bg-green-100 text-green-600 p-4 rounded-full mb-4"><i data-lucide="bed-double" class="w-8 h-8"></i></div>
                                                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">宿舍介绍</h3>
                                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">了解你的新家</p>
                                                    </a>
                                                    <a href="#" data-navlink='{"category": "学习科研", "page": "关于绩点和学分"}' class="nav-card bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-2xl dark:hover:shadow-purple-500/20 hover:-translate-y-2 transition-all duration-300 flex flex-col items-center text-center">
                                                        <div class="bg-purple-100 text-purple-600 p-4 rounded-full mb-4"><i data-lucide="graduation-cap" class="w-8 h-8"></i></div>
                                                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">学业发展</h3>
                                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">绩点、转专业、竞赛</p>
                                                    </a>
                                                    <a href="#" data-navlink='{"category": "答疑与支持", "page": "常见问题汇总"}' class="nav-card bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md hover:shadow-2xl dark:hover:shadow-red-500/20 hover:-translate-y-2 transition-all duration-300 flex flex-col items-center text-center">
                                                        <div class="bg-red-100 text-red-600 p-4 rounded-full mb-4"><i data-lucide="help-circle" class="w-8 h-8"></i></div>
                                                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">常见问题</h3>
                                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">新生疑惑解答</p>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>` 
                } }
            },
            "入学准备": {
                icon: "package-check",
                pages: {
                    "开学必备清单": { title: "开学必备清单", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto">
    <div class="p-6 rounded-xl w-full">
        <h3 class="text-2xl font-bold text-blue-800 dark:text-blue-400 mb-6 border-l-4 border-blue-700 dark:border-blue-500 pl-4">证件及文件类 (最重要！)</h3>
        <ul class="list-none space-y-4 text-gray-700 dark:text-gray-300">
            <li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 w-5 h-5 mr-3 mt-1 flex-shrink-0"></i><div><strong>录取通知书、高考准考证、身份证：</strong>最重要的身份证明，务必随身携带，妥善保管。</div></li>
            <li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 w-5 h-5 mr-3 mt-1 flex-shrink-0"></i><div><strong>身份证复印件：</strong>正反面复印在同一张A4纸上，建议准备3-4份，部分手续需要。</div></li>
            <li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 w-5 h-5 mr-3 mt-1 flex-shrink-0"></i><div><strong>户口本本人页复印件：</strong>申请助学金或办理户口迁移时可能需要。</div></li>
            <li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 w-5 h-5 mr-3 mt-1 flex-shrink-0"></i><div><strong>一寸/两寸证件照：</strong>红蓝白底各准备一版（约8-16张），用于办理学生证、体检、社团申请等。</div></li>
            <li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 w-5 h-5 mr-3 mt-1 flex-shrink-0"></i><div><strong>党/团组织关系材料：</strong>团员证及相关档案，按学校要求办理转接手续。</div></li>
            <li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 w-5 h-5 mr-3 mt-1 flex-shrink-0"></i><div><strong>学生档案：</strong>部分地区需要学生自带，请确认清楚并妥善保管，切勿私自拆封！</div></li>
        </ul>
    </div>
    
    <div class="grid md:grid-cols-2 gap-x-8 mt-8">
        <div class="p-6 rounded-xl w-full">
            <h3 class="text-2xl font-bold text-green-800 dark:text-green-400 mb-6 border-l-4 border-green-700 dark:border-green-500 pl-4">床上用品</h3>
            <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                <li>床垫、被子、枕头</li>
                <li>床单、被套、枕套（三件套）</li>
                <li>蚊帐、床帘（提高私密性）</li>
            </ul>
        </div>

        <div class="p-6 rounded-xl w-full">
            <h3 class="text-2xl font-bold text-cyan-800 dark:text-cyan-400 mb-6 border-l-4 border-cyan-700 dark:border-cyan-500 pl-4">洗漱用品</h3>
            <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                <li>牙刷、牙膏、漱口杯</li>
                <li>毛巾、浴巾</li>
                <li>洗发水、沐浴露、洗面奶</li>
                <li>脸盆、水桶</li>
                <li>洗衣液、肥皂、皂盒</li>
            </ul>
        </div>

        <div class="p-6 rounded-xl w-full mt-4">
            <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-400 mb-6 border-l-4 border-purple-700 dark:border-purple-500 pl-4">衣物鞋袜</h3>
            <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                <li>根据连云港气候准备四季衣物</li>
                <li>睡衣、居家服</li>
                <li>拖鞋、运动鞋、日常穿着的鞋</li>
                <li>袜子、内衣裤（多备几套）</li>
                <li>衣架、裤架、收纳袋</li>
            </ul>
        </div>

        <div class="p-6 rounded-xl w-full mt-4">
            <h3 class="text-2xl font-bold text-orange-800 dark:text-orange-400 mb-6 border-l-4 border-orange-700 dark:border-orange-500 pl-4">电子产品及其它</h3>
            <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                <li>手机、充电器、充电宝</li>
                <li>笔记本电脑、鼠标、U盘</li>
                <li>耳机、数据线</li>
                <li>台灯、可用于床头的夹灯</li>
                <li>带有多孔位的插排</li>
                <li>少量现金以备不时之需</li>
            </ul>
        </div>
    </div>

    <div class="bg-yellow-100 dark:bg-yellow-900/20 border-l-4 border-yellow-500 text-yellow-800 dark:text-yellow-300 p-6 rounded-lg w-full mt-10" role="alert">
        <div class="flex">
            <div class="py-1"><i data-lucide="alert-triangle" class="w-6 h-6 text-yellow-600 mr-4 flex-shrink-0"></i></div>
            <div>
                <p class="font-bold">温馨提示</p>
                <ul class="list-disc list-inside mt-2 text-sm">
                    <li>大件物品如被褥、床垫等，若路途遥远，建议到校后购买或提前邮寄至学校，以减轻行李负担。</li>
                    <li>电脑等贵重电子产品，建议到校安顿好后再购买或由家人寄送。</li>
                    <li>可以准备一些个人常用药品，如感冒药、创可贴、肠胃药等。</li>
                </ul>
            </div>
        </div>
    </div>
</div>` },
                    "新生入学流程": { title: "新生入学流程", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><div class="relative border-l-4 border-blue-500 pl-10 space-y-16 py-6 w-full"><div class="absolute w-4 h-4 bg-blue-600 rounded-full -left-2 top-6 ring-8 ring-white dark:ring-gray-800"></div><div class="relative"><h3 class="text-xl font-bold text-blue-800 dark:text-blue-400">第一步：报到注册</h3><p class="text-gray-600 dark:text-gray-300 mt-2">在指定日期（通常在9月4号到8号，每年不固定），在红马甲志愿者（都是学长学姐门）的引导下，前往所在学院的迎新点->找到自己对应的班级->在有电脑的地方刷身份证进行登记->找到坐在帐篷里的班助->提交身份证复印件+录取通知书原件并登记面前的登记表->领取①校园手提袋②海大蓝T恤③军训服装领取卡④入学体检单⑤学生手册⑥宿舍床上用品领取单（选购）等材料。班助，辅导员和迎新学长学姐会在此等候。</p></div><div class="absolute w-4 h-4 bg-blue-600 rounded-full -left-2" style="top: 33.33%"></div><div class="relative"><h3 class="text-xl font-bold text-blue-800 dark:text-blue-400">第二步：入住寝室</h3><p class="text-gray-600 dark:text-gray-300 mt-2">在负责运送行李的红马甲志愿者的带领下前往自己的宿舍楼和房间，在宿管阿姨处办理入住手续，注册完美校园，领取房卡（部分地区用校园卡就可以刷开门）。整理个人物品，打扫卫生，与新室友见面，熟悉环境。</p></div><div class="absolute w-4 h-4 bg-blue-600 rounded-full -left-2" style="top: 66.66%"></div><div class="relative"><h3 class="text-xl font-bold text-blue-800 dark:text-blue-400">第三步：办理各项手续</h3><p class="text-gray-600 dark:text-gray-300 mt-2">缴纳学费、住宿费（请关注江苏海洋大学财务平台微信公众号）；根据需要办理户口迁移；参加学校统一组织的入学体检，会在报道的第二天开始进行，通常在第二人民医院，在集合点坐车去。</p></div><div class="absolute w-4 h-4 bg-blue-600 rounded-full -left-2 bottom-6 ring-8 ring-white dark:ring-gray-800"></div><div class="relative"><h3 class="text-xl font-bold text-blue-800 dark:text-blue-400">第四步：开启新生活</h3><p class="text-gray-600 dark:text-gray-300 mt-2">参加开学典礼、军训动员大会、班级会议。之后将开始军训和正式的课程学习，正式开启大学生活！</p></div></div></div>` },
                    "开学须知": { title: "开学须知", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><div class="space-y-6"><div class="border-b dark:border-gray-700 pb-4"><h4 class="font-bold text-xl text-gray-800 dark:text-gray-100 flex items-center"><i data-lucide="calendar-days" class="text-indigo-500 mr-3"></i>报到时间与地点</h4><p class="text-gray-600 dark:text-gray-300 mt-2 pl-8">请严格按照录取通知书上的时间和地点报到，不要过早或过晚。如有特殊情况（如因病、交通问题等）无法按时报到，务必提前联系班助、学院辅导员说明情况，办理请假手续。</p></div><div class="border-b dark:border-gray-700 pb-4"><h4 class="font-bold text-xl text-gray-800 dark:text-gray-100 flex items-center"><i data-lucide="shield-check" class="text-red-500 mr-3"></i>安全问题</h4><p class="text-gray-600 dark:text-gray-300 mt-2 pl-8">注意人身和财产安全，保管好个人贵重物品。警惕陌生人的过度热情和推销，特别是上门推销电话卡、文具等。不要轻易相信任何要求转账汇款的信息，谨防电信诈骗和校园贷陷阱。</p></div><div><h4 class="font-bold text-xl text-gray-800 dark:text-gray-100 flex items-center"><i data-lucide="file-archive" class="text-yellow-500 mr-3"></i>档案转移</h4><p class="text-gray-600 dark:text-gray-300 mt-2 pl-8">确认自己的党/团组织关系和学生档案是否已按要求转至学校。自带档案的同学，报到后应立即将档案上交至指定部门，切勿私自拆封。</p></div></div></div>` },
                    "军训攻略": { title: "军训攻略", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-6xl mx-auto"><div class="grid md:grid-cols-2 gap-8"><div class="p-6 rounded-xl"><h3 class="text-2xl font-bold text-teal-800 dark:text-teal-400 mb-6 border-l-4 border-teal-700 dark:border-teal-500 pl-4">军训攻略</h3><ul class="list-disc list-inside space-y-3 text-gray-700 dark:text-gray-300"><li><strong>待开发</strong></li></ul></div></div></div>` }
                }
            },
            "校园生活": {
                icon: "utensils-crossed",
                pages: {
                    "食堂介绍": { title: "食堂介绍", isCampusSpecific: true },
                    "宿舍介绍": { title: "宿舍介绍", isCampusSpecific: true },
                    "校园超市与共享单车": { title: "校园超市与共享单车", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><div class="p-6 rounded-xl w-full"><h3 class="text-2xl font-bold text-purple-800 dark:text-purple-400 mb-4 border-l-4 border-purple-700 dark:border-purple-500 pl-4">校园超市</h3><p class="text-gray-700 dark:text-gray-300">校内设有多个超市，苍梧校区在三食堂旁、顺丰快递旁有超市。支持使用校园卡、微信、支付宝等多种支付方式。</p></div><div class="p-6 rounded-xl w-full mt-8"><h3 class="text-2xl font-bold text-sky-800 dark:text-sky-400 mb-4 border-l-4 border-sky-700 dark:border-sky-500 pl-4">校园共享单车</h3><p class="text-gray-700 dark:text-gray-300">由于校园面积较大，各功能区之间有一定距离，共享单车是校内非常便捷的代步工具。校园内有7MA”小蓝车“，用微信扫码即可开锁使用。请大家注意遵守交通规则，并将车辆停放在指定的划线区域内，共同维护校园环境。</p></div></div>` },
                    "社团与组织": { title: "社团与组织", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><div class="w-full"><h3 class="text-2xl font-bold text-rose-800 dark:text-rose-400 mb-6 border-l-4 border-rose-700 dark:border-rose-500 pl-4">学生社团</h3><p class="text-gray-700 dark:text-gray-300 mb-4">大学生活不只有学习，丰富多彩的社团活动是结交朋友、培养兴趣、提升能力的重要平台。我校拥有上百个学生社团，百花齐放，主要分为以下几类：</p><ul class="list-disc list-inside space-y-2 text-gray-600 dark:text-gray-400"><li><strong>学术科技类：</strong>如机器人协会、程序设计爱好者协会等，适合热爱钻研的你。</li><li><strong>文化艺术类：</strong>如书画社、汉服社、吉他社、舞蹈团等，是文艺青年的聚集地。</li><li><strong>体育竞技类：</strong>如篮球协会、足球协会、轮滑社、武术协会等，挥洒汗水，强健体魄。</li><li><strong>志愿服务类：</strong>如青年志愿者协会等，奉献爱心，服务社会。</li></ul><p class="text-gray-700 dark:text-gray-300 mt-4">每年开学季，学校都会举办盛大的“百团大战”社团招新活动，届时所有社团都会集中展示自己，是了解和加入社团的最佳时机！</p></div><div class="w-full mt-8"><h3 class="text-2xl font-bold text-indigo-800 dark:text-indigo-400 mb-6 border-l-4 border-indigo-700 dark:border-indigo-500 pl-4">团学组织</h3><p class="text-gray-700 dark:text-gray-300">团学组织是学生自我管理、自我服务、自我教育的重要载体，主要包括校级和院级的<strong>学生会各部门和团委</strong>等。加入这些组织，不仅可以锻炼自己的组织协调、沟通表达、活动策划等多方面能力，还能更深入地参与到学校和学院的管理服务工作中，为同学们发声，为校园建设贡献力量。团学组织的招新信息通常会在开学后通过官方公众号、班级群等渠道发布，有意向的同学可以多多关注。</p></div></div>` }
                }
            },
            "学习科研": {
                icon: "graduation-cap",
                pages: {
                    "关于绩点和学分": { title: "关于绩点和学分", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><div class="space-y-8"><div><h4 class="font-bold text-2xl text-gray-800 dark:text-gray-100 flex items-center mb-4"><i data-lucide="star" class="text-yellow-500 mr-3"></i>学分 (Credit)</h4><p class="text-gray-600 dark:text-gray-300 text-lg">学分是衡量你学习量的单位。每门课程都有固定的学分，例如“高等数学”可能是4个学分，“大学体育”可能是1个学分。你必须在大学期间修满培养方案规定的<strong>总学分</strong>和<strong>各类课程（如必修课、选修课）的最低学分要求</strong>，才能顺利毕业。所以，请务必认真对待每一门课程。</p></div><div class="border-t my-6 dark:border-gray-700"></div><div><h4 class="font-bold text-2xl text-gray-800 dark:text-gray-100 flex items-center mb-4"><i data-lucide="trending-up" class="text-green-500 mr-3"></i>绩点 (GPA)</h4><p class="text-gray-600 dark:text-gray-300 text-lg">绩点（Grade Point Average）是衡量你学习质量的核心指标，它由你的课程成绩按照特定公式换算而来（通常分数越高，绩点越高）。绩点非常重要，它直接影响到你的<strong>奖学金评定、评优评先</strong>等方方面面。一个高的绩点是你大学学习成果的最直观体现，请从大一开始就努力保持良好的成绩！</p></div></div></div>` },
                    "关于转专业": { title: "关于转专业", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4">转专业政策简介</h3><p class="text-gray-600 dark:text-gray-300">学校为给学生提供更多自主选择和发展的机会，设立了转专业制度。通常在大一学年结束后，符合条件的学生可以申请转入其他专业学习。具体政策请关注教务处通知。</p></div>` },
                    "竞赛与证书": { title: "竞赛与证书", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6">积极参与，提升自我</h3><p class="text-gray-600 dark:text-gray-300 mb-6">参加学科竞赛和考取有含金量的证书是提升个人综合能力、增加未来竞争力的重要途径。</p></div>` }
                }
            },
            "数字化校园": {
                icon: "smartphone",
                pages: {
                    "校园卡与APP": { title: "校园卡与完美校园APP", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6">校园一卡通与APP</h3><p class="text-gray-600 dark:text-gray-300">校园卡是校内身份识别和消费的重要凭证。配合“完美校园”APP可以进行充值、查询消费记录、缴纳网费电费等。</p></div>` },
                    "宽带与电费": { title: "宿舍宽带与电费缴纳", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><div class="w-full"><h3 class="text-2xl font-bold text-cyan-800 dark:text-cyan-400 mb-6 border-l-4 border-cyan-700 dark:border-cyan-500 pl-4">宿舍宽带使用教程</h3><p class="text-gray-700 dark:text-gray-300 mb-4">宿舍上网需要自行办理。一般流程如下：</p><ol class="list-decimal list-inside space-y-2 text-gray-600 dark:text-gray-400"><li><strong>选择运营商：</strong>开学时，中国移动、联通、电信三大运营商都会在校内设点，提供不同价格和速率的校园套餐，可根据需求自行选择。</li><li><strong>连接与认证：</strong>将网线连接到宿舍墙上的网络端口和你的电脑（或路由器）连接并拨号。以Win11系统举例，拨号界面在设置->网络和Internet->拨号，第一次使用时候设置新连接，移动的账号是学号@cmcc，电信是学号@telecom，联通是学号@unicom，密码都为身份证后八位。</li></ol></div><div class="w-full mt-8"><h3 class="text-2xl font-bold text-amber-800 dark:text-amber-400 mb-6 border-l-4 border-amber-700 dark:border-amber-500 pl-4">电费查询及缴纳</h3><p class="text-gray-700 dark:text-gray-300">请关注”江苏海洋大学微后勤”微信公众号，可以查询宿舍的电费信息并缴纳电费。每个宿舍每学期有少量免费用电额度。</p></div></div>` },
                    "WebVPN系统": { title: "江苏海洋大学WebVPN系统", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4">什么是WebVPN？</h3><p class="text-gray-600 dark:text-gray-300">WebVPN是一个神奇的工具，它能让你在校外也能像在校园网内一样，访问学校内部的各种网络资源，如图书馆数据库、教务系统等。</p><h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4">我该如何使用WebVPN</h3> WebVPN网站：http://webvpn.jou.edu.cn:58888/login ，账号是学号，密码默认是身份证后8位，登陆后点击“统一门户”，在校需要的功能基本上都能在里面找到。</div>` }
                }
            },
            "答疑与支持": {
                icon: "life-buoy",
                pages: {
                    "常见问题汇总": { title: "常见问题汇总 (FAQ)", type: "faq", items: [
                        { q: "学校的快递点在哪里？怎么收发快递？", a: "校内设有菜鸟驿站。你的快递会被送到驿站，凭取件码即可领取。寄快递也可以在驿站操作，非常方便。" },
                        { q: "生病了要去哪里看病？医保怎么用？", a: "校内设有校医院，可以处理常见的头疼感冒、小外伤等。凭校园卡挂号看病，可享受学生医保报销。如果病情较重，校医院医生会建议并协助转诊至校外的大型医院。" },
                        { q: "如何查询课程表和成绩？", a: "可以通过学校的教务系统网站查询个人课程表、考试安排和各科成绩。" },
                        { q: "校园网经常掉线或者速度慢怎么办？", a: "首先可以尝试重启路由器或电脑。如果问题依然存在，可以联系你所办理的运营商客服报修。" }
                    ] },
                    "重要部门联系方式": { title: "重要部门联系方式", content: `<div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-4xl mx-auto"><h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6">学校官网链接：</h3><div class="overflow-x-auto"><table class="w-full text-left"><thead><p style="color: rgb(0, 0, 255);"><a href="https://www.jou.edu.cn/bgdhcx.htm">https://www.jou.edu.cn/bgdhcx.htm</a></p>` }
                }
            }
        };

        // 校区特定数据
        const campusData = {
            cangwu: {
                name: "苍梧校区",
                dormitory: {
                    title: "苍梧校区宿舍介绍",
                    items: {
                        'a_dorm': {
                            name: 'A区宿舍 (女生)',
                            image: 'images/苍梧校区/宿舍/A区宿舍.jpg',
                            summary: '主要为女生宿舍，靠近三食堂和浴室，生活便利。',
                            details: [
                                {
                                    building: 'A1-A4,A8-A10栋',
                                    image: 'images/苍梧校区/宿舍/A区/A1-A4,A8-A9栋楼/A1-A4,A8-A9宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上下铺',
                                    bathroom: '独立卫生间，澡堂在三食堂附近',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '一楼有洗衣房',
                                    waterHeater: '部分楼层有',
                                    price: '1200元/年',
                                    notes: '传统的宿舍结构，空间紧凑但生活气息浓厚。开门使用校卡'
                                },
                                {
                                    building: 'A5-A8栋',
                                    image: 'images/苍梧校区/宿舍/A区/A5-A8栋楼/A5-A8栋楼宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上床下桌',
                                    bathroom: '独立卫生间，澡堂在三食堂附近',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '一楼有洗衣房',
                                    waterHeater: '部分楼层有',
                                    price: '1200元/年',
                                    notes: '24年暑假刚装修过，装修后变成上床下桌了，宿舍内环境新颖友好。开门使用校卡'
                                },
                            ]
                        },
                        'b_dorm': { 
                            name: 'B区宿舍 (男生)', 
                            image: 'images/苍梧校区/宿舍/B区宿舍.jpg', 
                            summary: '主要为男生宿舍，楼栋数量多，覆盖多个学院。', 
                            details: [
                                {
                                    building: 'B1-B4栋',
                                    image: 'images/苍梧校区/宿舍/B区/B1-B4/B1-B4宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上下铺，床对面一排桌子',
                                    bathroom: '三食堂西边',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: 'B5楼下，篮球场南边',
                                    waterHeater: '每层楼一个热水机，24H供热水',
                                    price: '1200元/年',
                                    notes: 'B区是最大的宿舍区之一，楼下有小卖部和活动空间。开门使用单独的门卡。'
                                },
                                {
                                    building: 'B5-B6栋',
                                    image: 'images/苍梧校区/宿舍/B区/B5-B6/B5-B6宿舍内景.jpg', 
                                    roomType: '四人间',
                                    layout: '上床下桌',
                                    bathroom: '公共卫生间，公共浴室在三食堂西边',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: 'B5楼下，篮球场南边',
                                    waterHeater: '每层楼一个热水机，24H供热水',
                                    price: '1000（3、4人间）',
                                    notes: 'B区是最大的宿舍区之一，楼下有小卖部和活动空间。开门使用单独的门卡。'
                                },
                                {
                                    building: 'B7-B12栋',
                                    image: 'images/苍梧校区/宿舍/B区/B7-B12/B7-B12宿舍内景.jpg', 
                                    roomType: '六人间',
                                    layout: '上下铺',
                                    bathroom: '有独立卫生间',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '洗衣房在B5楼下，篮球场南边',
                                    waterHeater: '部分楼层有开水',
                                    price: '950元/年',
                                    notes: 'B区是最大的宿舍区之一，楼下有小卖部和活动空间。开门使用单独的门卡。'
                                },
                            ]
                        },
                        'd_dorm': { 
                            name: 'D区宿舍 (东区)', 
                            image: 'images/苍梧校区/宿舍/D区宿舍.jpg', 
                            summary: '男女生宿舍都有，四人间独立卫浴，条件优越。', 
                            details: [
                                {
                                    building: 'D5-6，D9-10栋',
                                    image: 'images/苍梧校区/宿舍/D区/D5,6,9,10/D5,6,9,10宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上床下桌',
                                    bathroom: '独立卫浴，一楼也有公共澡堂',
                                    ac: '有',
                                    balcony: '两个宿舍共用一个大阳台',
                                    network: '周日至周四24:00断电',
                                    laundry: '宿舍楼一楼有公共洗衣房',
                                    waterHeater: '宿舍内刷卡可取热水，每层楼有一个饮水机',
                                    price: '1500元/年（未免费供应热水，实际按1350元/年收取）',
                                    notes: '位于学校东侧，也被称为东区宿舍，靠近东区食堂和四号门，环境安静。'
                                },
                                {
                                    building: 'D7-8栋',
                                    image: 'images/苍梧校区/宿舍/D区/D7-D8栋楼/D7-D8栋楼宿舍内景.jpg',
                                    roomType: '三人间',
                                    layout: '上床下桌',
                                    bathroom: '独立卫浴',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '宿舍楼一楼有洗衣房',
                                    waterHeater: '每层楼有热水机',
                                    price: '1500元/年',
                                    notes: '位于学校东侧，也被称为东区宿舍，靠近东区食堂和四号门，环境安静。'
                                },
                            ]
                        }
                    }
                },
                canteen: {
                    title: "苍梧校区食堂介绍(未完成，内容仅仅是占位用的，未核实，待开发)",
                    items: {
                        'canteen1': { 
                            name: '第一食堂', 
                            image: 'images/苍梧校区/食堂/第一食堂.jpg', 
                            summary: '位于大学生活动中心旁，上下课必经之路。', 
                            details: [
                                {
                                    area: '一楼大众菜',
                                    image: 'images/苍梧校区/食堂/一食堂快餐.jpg',
                                    specialty: ['自选快餐', '特色炒饭', '瓦罐汤'],
                                    priceRange: '人均8-15元',
                                    openingHours: '早餐 06:30-09:00 | 午餐 11:00-13:00 | 晚餐 17:00-19:00',
                                    notes: '主打便捷快餐，出餐速度快，是上下课间快速解决吃饭问题的首选。'
                                }
                            ]
                        },
                        'canteen2': { 
                            name: '第二食堂 & 风味餐厅', 
                            image: 'images/苍梧校区/食堂/第二食堂.jpg', 
                            summary: '位于海洋楼旁，离教学区最近，装修典雅。', 
                            details: [
                               {
                                    area: '一楼：第二食堂',
                                    image: 'images/苍梧校区/食堂/二食堂大众菜.jpg',
                                    specialty: ['大众快餐', '特色面食', '早餐'],
                                    priceRange: '人均8-15元',
                                    openingHours: '早餐 06:30-09:00 | 午餐 11:00-13:00 | 晚餐 17:00-19:00',
                                    notes: '离教学楼最近，菜品实惠，是解决日常三餐的主要场所。'
                                },
                                {
                                    area: '二楼：风味餐厅',
                                    image: 'images/苍梧校区/食堂/风味餐厅.jpg',
                                    specialty: ['木桶饭', '铁板饭', '石锅拌饭', '果茶饮品'],
                                    priceRange: '人均15-25元',
                                    openingHours: '午餐 11:00-13:30 | 晚餐 17:00-19:30',
                                    notes: '环境优雅，提供各地风味美食，适合改善伙食或朋友小聚。'
                                }
                            ]
                        },
                        'canteen3': { 
                            name: '第三 & 第四食堂', 
                            image: 'images/苍梧校区/食堂/第三食堂.jpg', 
                            summary: '网红餐厅，种类丰富，小火锅和麻辣烫是特色。', 
                            details: [
                                {
                                    area: '一楼：第三食堂',
                                    image: 'images/苍梧校区/食堂/三食堂快餐.jpg',
                                    specialty: ['5元特价快餐', '精品小炒', '肠粉'],
                                    priceRange: '人均5-18元',
                                    openingHours: '午餐 11:00-13:00 | 晚餐 17:00-19:00',
                                    notes: '以其超高性价比的5元快餐闻名，是月底的“救星”。'
                                },
                                {
                                    area: '二楼：第四食堂',
                                    image: 'images/苍梧校区/食堂/四食堂麻辣烫.jpg',
                                    specialty: ['麻辣烫', '旋转小火锅', '烤肉饭'],
                                    priceRange: '人均15-30元',
                                    openingHours: '午餐 11:00-14:00 | 晚餐 17:00-21:00',
                                    notes: '学校的美食中心，选择多样，麻辣烫和小火锅人气超高，晚上营业时间较长。'
                                }
                            ]
                        },
                        'canteen_east': { 
                            name: '东区食堂', 
                            image: 'images/苍梧校区/食堂/东区食堂.jpg', 
                            summary: 'D区食堂，空间大，座位多。', 
                            details: [
                                {
                                    area: '一楼 & 二楼',
                                    image: 'images/苍梧校区/食堂/东区食堂大厅.jpg',
                                    specialty: ['大众快餐', '面食窗口', '水饺馄饨', '轻食沙拉'],
                                    priceRange: '人均10-20元',
                                    openingHours: '早餐 06:30-09:00 | 午餐 11:00-13:00 | 晚餐 17:00-19:00',
                                    notes: '空间宽敞明亮，座位充足，不用担心饭点找不到位置。服务D区及附近师生。'
                                }
                            ]
                        },
                        'canteen_ethnic': { 
                            name: '民族餐厅', 
                            image: 'images/苍梧校区/食堂/民族餐厅.jpg', 
                            summary: '位于医务室旁，清真食堂。', 
                            details: [
                               {
                                    area: '清真美食',
                                    image: 'images/苍梧校区/食堂/民族餐厅美食.jpg',
                                    specialty: ['兰州拉面', '大盘鸡', '羊肉串', '特色早餐'],
                                    priceRange: '人均12-25元',
                                    openingHours: '早餐 06:30-09:00 | 午餐 11:00-13:30 | 晚餐 17:00-19:30',
                                    notes: '严格的清真食堂，为有需要的同学提供地道的民族风味美食，早餐的饼类尤其受欢迎。'
                                }
                            ]
                        },
                        'canteen_south': { 
                            name: '南园餐厅', 
                            image: 'images/苍梧校区/食堂/南园餐厅.jpg', 
                            summary: '位于文予楼旁，特色是宴席。', 
                            details: [
                                {
                                    area: '家常小炒 & 宴席',
                                    image: 'images/苍梧校区/食堂/南园餐厅包间.jpg',
                                    specialty: ['家常炒菜', '特色淮扬菜', '承办宴席'],
                                    priceRange: '人均30-80元',
                                    openingHours: '午餐 11:00-14:00 | 晚餐 17:00-21:00',
                                    notes: '更像是校内的社会餐厅，提供点菜服务和包间，适合班级聚餐、生日宴请等活动。'
                                }
                            ]
                        }
                    }
                }
            },
            tongguan: {
                name: "通灌校区",
                dormitory: {
                    title: "通灌校区宿舍介绍",
                    items: {
                        'jinxiu_dorm': { 
                            name: '锦绣宿舍', 
                            image: 'images/通灌校区/宿舍/锦绣宿舍.jpg', 
                            summary: '通灌校区主要学生宿舍区。', 
                            details: [
                                {
                                    building: '锦绣1,2,5号楼',
                                    image: 'images/通灌校区/宿舍/锦绣1,2,5号楼/锦绣1,2,5号楼宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上下铺',
                                    bathroom: '无独立卫生间，每层楼有隔间式厕所，有人定期打扫。澡堂在前程餐厅旁',
                                    ac: '有',
                                    balcony: '无',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '部分楼层有公共洗衣机',
                                    waterHeater: '部分楼层有开水炉',
                                    price: '900元/年',
                                    notes: '部分水泥地部分有地砖，桌子上面有柜子可以放东西，宿舍还有大柜子，每个宿舍都有一套打扫工具，每层楼都有大的洗漱台，宿舍开门使用钥匙'
                                },
                                {
                                    building: '锦绣3，4，8号楼',
                                    image: 'images/通灌校区/宿舍/锦绣3,4,8号楼/宿舍内情况.jpg', 
                                    roomType: '四人间（少量双人间）',
                                    layout: '上下铺',
                                    bathroom: '有独立卫生间，澡堂在前程餐厅旁',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '有',
                                    waterHeater: '双数楼层有热水机',
                                    price: '1200元/年',
                                    notes: '不仅每间宿舍内有洗漱台 每层楼也安排大洗漱台，开门使用钥匙'
                                },
                                {
                                    building: '锦绣6，7号楼',
                                    image: 'images/通灌校区/宿舍/锦绣6,7号楼/锦绣6,7号楼宿舍内景.jpg',
                                    roomType: '五人间，四个人上下铺，一个人上床下桌',
                                    layout: '上床下桌/上下铺',
                                    bathroom: '无独立卫生间，请到前程餐厅附近的澡堂洗澡',
                                    ac: '有',
                                    balcony: '无',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '两层中有一层会有洗衣机',
                                    waterHeater: '两层中有一层会有热水炉',
                                    price: '700元/年',
                                    notes: '部分水泥地部分地砖，开门使用钥匙。多出来的桌子是上床下桌，比其他桌子大一些'
                                }
                            ]
                        }
                    }
                },
                canteen: {
                    title: "通灌校区食堂介绍(未完成，内容仅仅是占位用的，未核实，待开发)",
                    items: {
                        'qiancheng_canteen': { 
                            name: '前程餐厅', 
                            image: 'images/通灌校区/食堂/前程餐厅.jpg', 
                            summary: '校区主食堂，满足日常用餐需求。', 
                            details: [
                                {
                                    area: '一楼 & 二楼',
                                    image: 'images/通灌校区/食堂/前程餐厅大厅.jpg',
                                    specialty: ['大众快餐', '地方特色小吃', '麻辣香锅'],
                                    priceRange: '人均10-20元',
                                    openingHours: '早餐 07:00-09:00 | 午餐 11:00-13:00 | 晚餐 17:00-19:00',
                                    notes: '菜品丰富，价格实惠，是通灌校区学生的主要就餐选择。'
                                }
                            ]
                        },
                        'food_square': { 
                            name: '美食广场', 
                            image: 'images/通灌校区/食堂/美食广场.jpg', 
                            summary: '汇集多种风味美食，提供多样化选择。', 
                            details: [
                                {
                                    area: '风味档口',
                                    image: 'images/通灌校区/食堂/美食广场档口.jpg',
                                    specialty: ['炸鸡汉堡', '奶茶饮品', '特色烧烤', '品牌连锁快餐'],
                                    priceRange: '人均15-30元',
                                    openingHours: '全天 10:00-21:00',
                                    notes: '年轻人喜爱的地方，营业时间长，适合休闲和夜宵。'
                                }
                            ]
                        }
                    }
                }
            },
            songtiao: {
                name: "宋跳校区",
                dormitory: {
                    title: "宋跳校区宿舍介绍",
                     items: {
                        'songtiao_dorm': { 
                            name: '宋跳校区宿舍', 
                            image: 'images/宋跳校区/宿舍/宋跳宿舍.jpg', 
                            summary: '宋跳校区学生生活区。',
                            details: [
                                {
                                    building: '1，2号楼',
                                    image: 'images/宋跳校区/宿舍/1,2号楼/1,2号楼宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上床下桌',
                                    bathroom: '无独立卫生间，楼内有公共卫生间。大澡堂洗澡',
                                    ac: '有',
                                    balcony: '无',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '阳台可自行安装洗衣机',
                                    waterHeater: '宿舍内独立热水器',
                                    price: '1000元/年',
                                    notes: '宿舍条件较好，均为标准四人间配置，生活舒适。新改造的卫生间有自洁功能'
                                },
                                {
                                building: '3，6号楼(六人间)',
                                    image: 'images/宋跳校区/宿舍/3,6号楼/3,6号楼宿舍内景.jpg',
                                    roomType: '六人间',
                                    layout: '上下铺',
                                    bathroom: '有独立卫生间，有公共卫生间，大澡堂洗澡',
                                    ac: '有',
                                    balcony: '未知',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '有',
                                    waterHeater: '未知',
                                    price: '1000元/年',
                                    notes: '宿舍条件较好，均为标准六人间配置，生活舒适。'
                                },
                                {
                                    building: '6号楼(四人间)，7，8号楼',
                                    image: 'images/宋跳校区/宿舍/6,7,8号楼/6,7,8号楼宿舍内景.jpg',
                                    roomType: '四人间',
                                    layout: '上床下桌',
                                    bathroom: '有独立卫生间和公共卫生间，大澡堂洗澡',
                                    ac: '有',
                                    balcony: '有',
                                    network: '周日至周四24:00断网，周五周六不断网',
                                    laundry: '未知',
                                    waterHeater: '未知',
                                    price: '1200元/年',
                                    notes: '宿舍条件较好，均为标准四人间配置，生活舒适。宿舍空间大。'
                                }
                            ]
                        }
                    }
                },
                canteen: {
                    title: "宋跳校区食堂介绍(未完成，内容仅仅是占位用的，未核实，待开发)",
                    items: {
                       'donggang_canteen': { 
                           name: '东港餐厅', 
                           image: 'images/宋跳校区/食堂/东港餐厅.jpg', 
                           summary: '校区内唯一的学生食堂。',
                           details: [
                               {
                                    area: '综合食堂',
                                    image: 'images/宋跳校区/食堂/东港餐厅菜品.jpg',
                                    specialty: ['大众快餐', '特色面点', '盖浇饭'],
                                    priceRange: '人均10-18元',
                                    openingHours: '早餐 07:00-09:00 | 午餐 11:00-13:00 | 晚餐 17:00-19:00',
                                    notes: '虽然选择不如主校区多，但能满足日常基本用餐需求，口味不错。'
                               }
                           ]
                        }
                    }
                }
            }
        };

        /**
         * 指南应用类
         */
        class GuideApp {
            constructor(commonData, specificData) {
                this.guideData = commonData;
                this.campusData = specificData;
                this.selectedCampus = null;
                this.observer = null;
                this.isScrollingProgrammatically = false;
                this.scrollTimeout = null;

                // 缓存DOM元素
                this.loadingOverlay = document.getElementById('loading-overlay');
                this.mainView = document.getElementById('main-view');
                this.navMenu = document.getElementById('nav-menu');
                this.contentArea = document.getElementById('content-area');
                this.contentTitle = document.getElementById('content-title');
                this.menuToggle = document.getElementById('menu-toggle');
                this.sidebar = document.getElementById('sidebar');
                this.homeButtonTop = document.getElementById('home-button-top');
                this.sidebarOverlay = document.getElementById('sidebar-overlay');
                this.campusModal = document.getElementById('campus-selector-modal');
                this.campusDialog = document.getElementById('campus-selector-dialog');
                this.changeCampusBtn = document.getElementById('change-campus-btn');
                this.currentCampusDisplay = document.getElementById('current-campus-display');

                // 详情页元素
                this.detailView = document.getElementById('detail-view');
                this.detailTitle = document.getElementById('detail-title');
                this.detailContent = document.getElementById('detail-content');
                this.backToMainBtn = document.getElementById('back-to-main-btn');
                
                // 搜索页元素
                this.searchView = document.getElementById('search-view');
                this.searchForm = document.getElementById('search-form');
                this.searchInput = document.getElementById('search-input');
                this.searchResultsContainer = document.getElementById('search-results-container');
                this.backToMainFromSearchBtn = document.getElementById('back-to-main-from-search-btn');

                // 新增功能元素
                this.themeToggleBtn = document.getElementById('theme-toggle-btn');
                this.feedbackBtn = document.getElementById('feedback-btn');
                this.feedbackModal = document.getElementById('feedback-modal');
                this.feedbackDialog = document.getElementById('feedback-dialog');
                this.closeFeedbackBtn = document.getElementById('close-feedback-btn');
                this.feedbackForm = document.getElementById('feedback-form');
                this.feedbackSuccessMsg = document.getElementById('feedback-success-msg');
            }

            init() {
                this._determineAndApplyInitialTheme();
                this._setupEventListeners();
                this.selectedCampus = localStorage.getItem('selectedCampus');

                if (this.selectedCampus) {
                    this.runApp();
                } else {
                    this._showCampusSelector();
                }

                // 隐藏加载动画
                setTimeout(() => {
                    this.loadingOverlay.style.opacity = '0';
                    setTimeout(() => this.loadingOverlay.style.display = 'none', 500);
                }, 500);
            }
            
            runApp() {
                this._createNav();
                this._renderAllContent();
                this._updateCampusDisplay();
                this._setupIntersectionObserver();
            }

            _createNav() {
                this.navMenu.innerHTML = ''; // 清空旧菜单
                for (const categoryKey in this.guideData) {
                    const categoryData = this.guideData[categoryKey];
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'nav-category';
                    
                    if (categoryData.isHomePage) {
                        const link = this._createNavLink(categoryKey, 'home', categoryData.icon, categoryKey, true);
                        this.navMenu.appendChild(link);
                        continue;
                    }

                    const categoryHeader = document.createElement('button');
                    categoryHeader.className = 'category-header w-full flex items-center justify-between px-4 py-2 text-sm font-semibold text-blue-200 dark:text-gray-300 rounded-md hover:bg-blue-800 dark:hover:bg-gray-700 transition-colors';
                    categoryHeader.innerHTML = `<span class="flex items-center"><i data-lucide="${categoryData.icon}" class="w-4 h-4 mr-3"></i>${categoryKey}</span><i data-lucide="chevron-down" class="accordion-icon w-4 h-4"></i>`;
                    categoryDiv.appendChild(categoryHeader);

                    const pageList = document.createElement('ul');
                    pageList.className = 'submenu mt-1';
                    for (const pageKey in categoryData.pages) {
                        const page = categoryData.pages[pageKey];
                        const listItem = document.createElement('li');
                        const link = this._createNavLink(categoryKey, pageKey, null, page.title, false);
                        listItem.appendChild(link);
                        pageList.appendChild(listItem);
                    }
                    categoryDiv.appendChild(pageList);
                    this.navMenu.appendChild(categoryDiv);
                }
                lucide.createIcons();
            }

            _createNavLink(categoryKey, pageKey, icon, text, isHeader) {
                const link = document.createElement('a');
                link.href = `#page-${categoryKey}-${pageKey}`;
                if (isHeader) {
                    link.className = 'sidebar-link flex items-center px-4 py-3 text-base font-semibold rounded-lg hover:bg-blue-700 dark:hover:bg-gray-700 transition-colors mb-4';
                    link.innerHTML = `<i data-lucide="${icon}" class="w-5 h-5 mr-3"></i> ${text}`;
                } else {
                    link.className = 'sidebar-link block pl-11 pr-4 py-2.5 text-sm rounded-md hover:bg-blue-700 dark:hover:bg-gray-700 transition-colors';
                    link.textContent = text;
                }
                link.dataset.category = categoryKey;
                link.dataset.page = pageKey;
                return link;
            }

            _renderAllContent() {
                if (this.observer) this.observer.disconnect();
                this.contentArea.innerHTML = '';

                for (const categoryKey in this.guideData) {
                    const categoryData = this.guideData[categoryKey];
                    for (const pageKey in categoryData.pages) {
                        const page = categoryData.pages[pageKey];
                        const section = document.createElement('div');
                        section.className = 'content-section';
                        section.id = `page-${categoryKey}-${pageKey}`;
                        section.dataset.pageKey = pageKey;
                        section.dataset.categoryKey = categoryKey;

                        if (page.isCampusSpecific) {
                            let contentHtml = '';
                            if (pageKey === '宿舍介绍') {
                                const items = this.campusData[this.selectedCampus]?.dormitory?.items;
                                contentHtml = this._generateCampusCards(items, 'dormitory');
                            } else if (pageKey === '食堂介绍') {
                                const items = this.campusData[this.selectedCampus]?.canteen?.items;
                                contentHtml = this._generateCampusCards(items, 'canteen');
                            }
                            section.innerHTML = contentHtml;
                        } else if (page.type === 'faq') {
                            section.innerHTML = this._createFaqHtml(page.items);
                            this._addFaqListeners(section);
                        } else {
                            section.innerHTML = page.content;
                        }
                        this.contentArea.appendChild(section);
                    }
                }
                
                this._addHomeListeners();
                lucide.createIcons();
            }
            
            _generateCampusCards(items, type) {
                 if (!items) return '<p class="text-gray-500 dark:text-gray-400">该校区暂无相关信息。</p>';
                 const itemKeys = Object.keys(items);
                 const cardHtml = itemKeys.map(key => {
                     const item = items[key];
                     return `
                         <a href="#" class="detail-card bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-1 transition-transform duration-300 group" data-type="${type}" data-key="${key}">
                             <div class="h-56 overflow-hidden">
                                 <img src="${item.image}" alt="[${item.name}的图片]" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300">
                             </div>
                             <div class="p-6">
                                 <h4 class="font-bold text-xl text-gray-900 dark:text-gray-100">${item.name}</h4>
                                 <p class="text-gray-600 dark:text-gray-400 text-sm mt-2">${item.summary}</p>
                             </div>
                         </a>
                     `;
                 }).join('');

                 return `<div class="w-full max-w-6xl mx-auto">
                             <h3 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mb-8 text-center">${type === 'dormitory' ? '宿舍概览' : '美食天地'}</h3>
                             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                 ${cardHtml}
                             </div>
                         </div>`;
            }


            _setupEventListeners() {
                this.navMenu.addEventListener('click', this._handleNavClick.bind(this));
                this.homeButtonTop.addEventListener('click', this._handleHomeClick.bind(this));
                this.menuToggle.addEventListener('click', this._toggleSidebar.bind(this));
                this.sidebarOverlay.addEventListener('click', this._toggleSidebar.bind(this));
                this.campusModal.addEventListener('click', this._handleCampusSelection.bind(this));
                this.changeCampusBtn.addEventListener('click', this._showCampusSelector.bind(this));
                
                // 详情页事件
                this.contentArea.addEventListener('click', this._handleCardClick.bind(this));
                this.backToMainBtn.addEventListener('click', this._hideDetailView.bind(this));

                // 搜索事件
                this.searchForm.addEventListener('submit', this._handleSearch.bind(this));
                this.backToMainFromSearchBtn.addEventListener('click', this._hideSearchView.bind(this));
                this.searchResultsContainer.addEventListener('click', this._handleSearchResultClick.bind(this));

                // 新增功能事件
                this.themeToggleBtn.addEventListener('click', this._handleThemeToggle.bind(this));
                this.feedbackBtn.addEventListener('click', this._showFeedbackModal.bind(this));
                this.closeFeedbackBtn.addEventListener('click', this._hideFeedbackModal.bind(this));
                this.feedbackModal.addEventListener('click', (e) => {
                    if (e.target === this.feedbackModal) this._hideFeedbackModal();
                });
                this.feedbackForm.addEventListener('submit', this._handleFeedbackSubmit.bind(this));
            }

            _showCampusSelector() {
                this.campusModal.classList.remove('hidden');
                setTimeout(() => {
                    this.campusModal.style.opacity = '1';
                    this.campusDialog.style.transform = 'scale(1)';
                    this.campusDialog.style.opacity = '1';
                }, 10);
            }

            _handleCampusSelection(e) {
                const button = e.target.closest('.campus-select-btn');
                if (!button) return;

                const campus = button.dataset.campus;
                localStorage.setItem('selectedCampus', campus);
                this.selectedCampus = campus;

                this.campusModal.style.opacity = '0';
                this.campusDialog.style.transform = 'scale(0.95)';
                this.campusDialog.style.opacity = '0';
                
                setTimeout(() => {
                    this.campusModal.classList.add('hidden');
                    this.runApp();
                }, 300);
            }
            
            _updateCampusDisplay() {
                if (this.selectedCampus && this.campusData[this.selectedCampus]) {
                    this.currentCampusDisplay.textContent = `当前: ${this.campusData[this.selectedCampus].name}`;
                }
            }

             _setupIntersectionObserver() {
                const options = {
                    root: this.contentArea,
                    threshold: 0,
                    rootMargin: `-${document.querySelector('header').offsetHeight}px 0px -${this.contentArea.clientHeight - document.querySelector('header').offsetHeight - 1}px 0px`
                };

                this.observer = new IntersectionObserver((entries) => {
                    if (this.isScrollingProgrammatically) return;
                    
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const { categoryKey, pageKey } = entry.target.dataset;
                            this._updateActiveState(categoryKey, pageKey);
                        }
                    });
                }, options);

                document.querySelectorAll('.content-section').forEach(section => {
                    this.observer.observe(section);
                });
            }
            
            _updateActiveState(categoryKey, pageKey) {
                const pageData = this.guideData[categoryKey]?.pages[pageKey];
                if (pageData) {
                    if (pageData.isCampusSpecific) {
                        let titleKey = '';
                        if (pageKey === '宿舍介绍') titleKey = 'dormitory';
                        if (pageKey === '食堂介绍') titleKey = 'canteen';
                        this.contentTitle.textContent = this.campusData[this.selectedCampus]?.[titleKey]?.title || pageData.title;
                    } else {
                        this.contentTitle.textContent = pageData.title;
                    }
                }
                document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                const activeLink = document.querySelector(`.sidebar-link[data-category="${categoryKey}"][data-page="${pageKey}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                    const submenu = activeLink.closest('.submenu');
                    if (submenu && !submenu.classList.contains('open')) {
                        document.querySelectorAll('.submenu.open').forEach(s => {
                            s.classList.remove('open');
                            s.previousElementSibling.classList.remove('open');
                        });
                        submenu.classList.add('open');
                        submenu.previousElementSibling.classList.add('open');
                    }
                }
            }
            
            _handleNavClick(e) {
                 const link = e.target.closest('.sidebar-link');
                 const header = e.target.closest('.category-header');
                 if (link) {
                     e.preventDefault();
                     this._hideAllViews();
                     const href = link.getAttribute('href');
                     if (href && href.startsWith('#')) {
                         const { category, page } = link.dataset;
                         this._updateActiveState(category, page);
                         const targetElement = document.getElementById(href.substring(1));
                         if (targetElement) this._scrollToElement(targetElement);
                         if (window.innerWidth < 768) this._toggleSidebar();
                     }
                 } else if (header) {
                     const submenu = header.nextElementSibling;
                     header.classList.toggle('open');
                     submenu.classList.toggle('open');
                 }
            }
            
            _handleHomeClick(e) {
                e.preventDefault();
                this._hideAllViews();
                const homeElement = document.getElementById('page-主页-home');
                if(homeElement) {
                    this._updateActiveState("主页", "home");
                    this._scrollToElement(homeElement);
                }
            }
            
            _toggleSidebar() {
                const isHidden = this.sidebar.classList.contains('-translate-x-full');
                this.sidebar.classList.toggle('-translate-x-full');
                this.sidebarOverlay.classList.toggle('hidden', !isHidden);
            }
            
            _scrollToElement(targetElement, keyword = null) {
                this.isScrollingProgrammatically = true;
                const topOffset = document.querySelector('header').offsetHeight;
                const elementPosition = targetElement.getBoundingClientRect().top;
                const offsetPosition = elementPosition + this.contentArea.scrollTop - topOffset;
                
                this.contentArea.scrollTo({ top: offsetPosition, behavior: 'smooth' });

                if (keyword) {
                    setTimeout(() => this._highlightKeywordInSection(targetElement, keyword), 500);
                }

                clearTimeout(this.scrollTimeout);
                this.scrollTimeout = setTimeout(() => { this.isScrollingProgrammatically = false; }, 1000); 
            }
            
            _createFaqHtml(items) {
                let html = '<div class="space-y-4 w-full max-w-4xl mx-auto">';
                items.forEach((item) => {
                    html += `<div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden"><div class="accordion-header w-full p-5 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><span class="text-lg">${item.q}</span><i data-lucide="chevron-down" class="accordion-icon transition-transform duration-300 w-5 h-5"></i></div><div class="accordion-content bg-gray-50 dark:bg-gray-700/50 p-5 border-t border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300" style="display: none;"><p>${item.a}</p></div></div>`;
                });
                html += '</div>';
                return html;
            }
            
            _addFaqListeners(container) {
                const headers = container.querySelectorAll('.accordion-header');
                headers.forEach(header => {
                    header.addEventListener('click', () => {
                        const content = header.nextElementSibling;
                        header.classList.toggle('open');
                        content.style.display = header.classList.contains('open') ? 'block' : 'none';
                        header.querySelector('.accordion-icon').classList.toggle('rotate-180');
                    });
                });
            }
            
            _addHomeListeners() {
                document.getElementById('explore-btn')?.addEventListener('click', (e) => {
                    e.preventDefault();
                    const nextSection = document.getElementById('page-入学准备-开学必备清单');
                    if (nextSection) {
                        this._updateActiveState("入学准备", "开学必备清单");
                        this._scrollToElement(nextSection);
                    }
                });
                this.contentArea.querySelectorAll('.nav-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        e.preventDefault();
                        const navData = JSON.parse(card.dataset.navlink);
                        const targetElement = document.getElementById(`page-${navData.category}-${navData.page}`);
                        if (targetElement) {
                             this._updateActiveState(navData.category, navData.page);
                             this._scrollToElement(targetElement);
                        }
                    });
                });
            }

            _hideAllViews() {
                this._hideDetailView();
                this._hideSearchView();
            }

            // --- 详情页方法 ---
            _handleCardClick(e) {
                const card = e.target.closest('.detail-card');
                if (!card) return;
                e.preventDefault();

                const { type, key } = card.dataset;
                this._showDetailView(type, key);
            }

            _generateDormitoryDetailsHtml(details) {
                return details.map(dorm => `
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg mb-6 shadow-md border border-gray-200 dark:border-gray-700">
                        <h4 class="font-bold text-xl text-blue-800 dark:text-blue-400 mb-4">${dorm.building}</h4>
                        <img src="${dorm.image}" alt="[${dorm.building}的图片]" class="w-full h-auto object-cover rounded-lg mb-4">
                        <ul class="space-y-3 text-gray-700 dark:text-gray-300">
                            <li class="flex items-center"><i data-lucide="users" class="w-5 h-5 mr-3 text-blue-500"></i><strong>房型：</strong> ${dorm.roomType}</li>
                            <li class="flex items-center"><i data-lucide="layout-grid" class="w-5 h-5 mr-3 text-blue-500"></i><strong>布局：</strong> ${dorm.layout}</li>
                            <li class="flex items-center"><i data-lucide="wallet" class="w-5 h-5 mr-3 text-blue-500"></i><strong>费用：</strong> ${dorm.price}</li>
                            <li class="flex items-center"><i data-lucide="shower-head" class="w-5 h-5 mr-3 text-blue-500"></i><strong>卫浴：</strong> ${dorm.bathroom}</li>
                            <li class="flex items-center"><i data-lucide="heater" class="w-5 h-5 mr-3 text-blue-500"></i><strong>热水：</strong> ${dorm.waterHeater}</li>
                            <li class="flex items-center"><i data-lucide="air-vent" class="w-5 h-5 mr-3 text-blue-500"></i><strong>空调：</strong> ${dorm.ac}</li>
                            <li class="flex items-center"><i data-lucide="sun" class="w-5 h-5 mr-3 text-blue-500"></i><strong>阳台：</strong> ${dorm.balcony}</li>
                            <li class="flex items-center"><i data-lucide="wifi" class="w-5 h-5 mr-3 text-blue-500"></i><strong>网络：</strong> ${dorm.network}</li>
                            <li class="flex items-center"><i data-lucide="washing-machine" class="w-5 h-5 mr-3 text-blue-500"></i><strong>洗衣：</strong> ${dorm.laundry}</li>
                            ${dorm.notes ? `<li class="flex items-start"><i data-lucide="info" class="w-5 h-5 mr-3 mt-1 text-blue-500 flex-shrink-0"></i><div><strong>备注：</strong> ${dorm.notes}</div></li>` : ''}
                        </ul>
                    </div>
                `).join('');
            }

            _generateCanteenDetailsHtml(details) {
                return details.map(canteen => `
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg mb-6 shadow-md border border-gray-200 dark:border-gray-700">
                        <h4 class="font-bold text-xl text-green-800 dark:text-green-400 mb-4">${canteen.area}</h4>
                         <img src="${canteen.image}" alt="[${canteen.area}的图片]" class="w-full h-auto object-cover rounded-lg mb-4">
                        <ul class="space-y-3 text-gray-700 dark:text-gray-300">
                            <li class="flex items-start"><i data-lucide="sparkles" class="w-5 h-5 mr-3 mt-1 text-green-500 flex-shrink-0"></i><div><strong>特色菜品：</strong> ${canteen.specialty.join('、 ')}</div></li>
                            <li class="flex items-center"><i data-lucide="wallet" class="w-5 h-5 mr-3 text-green-500"></i><strong>价格范围：</strong> ${canteen.priceRange}</li>
                            <li class="flex items-center"><i data-lucide="clock" class="w-5 h-5 mr-3 text-green-500"></i><strong>营业时间：</strong> ${canteen.openingHours}</li>
                            ${canteen.notes ? `<li class="flex items-start"><i data-lucide="info" class="w-5 h-5 mr-3 mt-1 text-green-500 flex-shrink-0"></i><div><strong>备注：</strong> ${canteen.notes}</div></li>` : ''}
                        </ul>
                    </div>
                `).join('');
            }

            _showDetailView(type, itemKey) {
                const itemData = this.campusData[this.selectedCampus]?.[type]?.items?.[itemKey];
                if (!itemData) return;

                this.detailTitle.textContent = itemData.name;

                let detailsHtml = '';
                if (Array.isArray(itemData.details)) {
                    if (type === 'dormitory') {
                        detailsHtml = this._generateDormitoryDetailsHtml(itemData.details);
                    } else if (type === 'canteen') {
                        detailsHtml = this._generateCanteenDetailsHtml(itemData.details);
                    }
                } else {
                    // Fallback for old string format
                    detailsHtml = `<div class="prose dark:prose-invert max-w-none">${itemData.details}</div>`;
                }

                this.detailContent.innerHTML = `
                    <div class="max-w-4xl mx-auto">
                        <img src="${itemData.image}" alt="[${itemData.name}的图片]" class="w-full h-auto max-h-[450px] object-cover rounded-xl shadow-lg mb-8">
                        <div class="bg-gray-100 dark:bg-gray-800/50 p-4 sm:p-8 rounded-xl">
                            <h3 class="text-2xl font-bold mb-6 border-b pb-4 dark:border-gray-700 text-gray-800 dark:text-gray-100">详细情况概览</h3>
                            ${detailsHtml}
                        </div>
                    </div>
                `;
                
                this.mainView.classList.add('hidden');
                this.detailView.classList.remove('hidden', 'translate-x-full');
                this.detailView.classList.add('flex');
                setTimeout(() => {
                    this.detailView.classList.remove('translate-x-full');
                }, 10);
                lucide.createIcons();
            }

            _hideDetailView() {
                if (!this.detailView.classList.contains('hidden')) {
                    this.detailView.classList.add('translate-x-full');
                    setTimeout(() => {
                        this.detailView.classList.add('hidden');
                        this.detailView.classList.remove('flex');
                        this.mainView.classList.remove('hidden');
                    }, 300);
                }
            }
            
            // --- 搜索功能方法 ---
            _handleSearch(e) {
                e.preventDefault();
                const query = this.searchInput.value.trim();
                if (query) {
                    const results = this._performSearch(query);
                    this._displaySearchResults(results, query);
                }
            }

            _performSearch(query) {
                const results = [];
                const tempDiv = document.createElement('div');
                const queryLower = query.toLowerCase();

                // 搜索通用数据
                for (const categoryKey in this.guideData) {
                    for (const pageKey in this.guideData[categoryKey].pages) {
                        const page = this.guideData[categoryKey].pages[pageKey];
                        
                        let searchableText = page.title;
                        tempDiv.innerHTML = page.content || '';
                        searchableText += ' ' + tempDiv.textContent;

                        if (page.type === 'faq') {
                            page.items.forEach(item => {
                                searchableText += ' ' + item.q + ' ' + item.a;
                            });
                        }

                        if (searchableText.toLowerCase().includes(queryLower)) {
                            results.push({
                                title: page.title,
                                text: tempDiv.textContent,
                                categoryKey,
                                pageKey
                            });
                        }
                    }
                }

                // 搜索校区特定数据
                const campus = this.campusData[this.selectedCampus];
                if (campus) {
                    ['dormitory', 'canteen'].forEach(type => {
                        if (campus[type] && campus[type].items) {
                            for (const itemKey in campus[type].items) {
                                const item = campus[type].items[itemKey];
                                let searchableText = `${item.name} ${item.summary}`;
                                // **搜索逻辑更新**：如果details是数组，则搜索数组内的文本
                                if (Array.isArray(item.details)) {
                                    searchableText += item.details.map(d => Object.values(d).join(' ')).join(' ');
                                } else if (typeof item.details === 'string') {
                                    tempDiv.innerHTML = item.details;
                                    searchableText += ' ' + tempDiv.textContent;
                                }

                                if (searchableText.toLowerCase().includes(queryLower)) {
                                    results.push({
                                        title: item.name,
                                        text: searchableText,
                                        isDetail: true,
                                        detailType: type,
                                        detailKey: itemKey
                                    });
                                }
                            }
                        }
                    });
                }
                
                return results;
            }

            _displaySearchResults(results, query) {
                if (results.length === 0) {
                    this.searchResultsContainer.innerHTML = `<p class="text-center text-gray-500 dark:text-gray-400">未能找到与“${query}”相关的内容。</p>`;
                } else {
                    this.searchResultsContainer.innerHTML = results.map(result => {
                        const snippet = this._createSnippet(result.text, query);
                        const highlightedSnippet = snippet.replace(new RegExp(query, 'gi'), (match) => `<mark class="search-highlight">${match}</mark>`);
                        
                        const dataAttrs = result.isDetail
                            ? `data-is-detail="true" data-detail-type="${result.detailType}" data-detail-key="${result.detailKey}"`
                            : `data-category-key="${result.categoryKey}" data-page-key="${result.pageKey}"`;

                        return `
                            <a href="#" class="search-result-item block p-4 mb-4 bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-md dark:hover:bg-gray-700 transition-shadow" ${dataAttrs} data-keyword="${query}">
                                <h4 class="font-bold text-blue-800 dark:text-blue-400">${result.title}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">...${highlightedSnippet}...</p>
                            </a>
                        `;
                    }).join('');
                }

                this.mainView.classList.add('hidden');
                this.searchView.classList.remove('hidden', 'translate-x-full');
                this.searchView.classList.add('flex');
                 setTimeout(() => {
                     this.searchView.classList.remove('translate-x-full');
                 }, 10);
            }

            _createSnippet(text, query) {
                const index = text.toLowerCase().indexOf(query.toLowerCase());
                if (index === -1) return text.substring(0, 100);

                const start = Math.max(0, index - 30);
                const end = Math.min(text.length, index + query.length + 70);
                return text.substring(start, end);
            }

            _hideSearchView() {
                if (!this.searchView.classList.contains('hidden')) {
                    this.searchView.classList.add('translate-x-full');
                    setTimeout(() => {
                        this.searchView.classList.add('hidden');
                        this.searchView.classList.remove('flex');
                        this.mainView.classList.remove('hidden');
                        this.searchInput.value = '';
                    }, 300);
                }
            }

            _handleSearchResultClick(e) {
                const item = e.target.closest('.search-result-item');
                if (!item) return;
                e.preventDefault();

                this._hideSearchView();
                const { isDetail, detailType, detailKey, categoryKey, pageKey, keyword } = item.dataset;
                
                if (isDetail) {
                    this._showDetailView(detailType, detailKey);
                    // 在详情页高亮关键词
                    setTimeout(() => this._highlightKeywordInSection(this.detailContent, keyword), 500);
                } else {
                    const targetElement = document.getElementById(`page-${categoryKey}-${pageKey}`);
                    if (targetElement) {
                        this._updateActiveState(categoryKey, pageKey);
                        this._scrollToElement(targetElement, keyword);
                    }
                }
            }

            _highlightKeywordInSection(sectionElement, keyword) {
                const regex = new RegExp(keyword, 'gi');
                const walker = document.createTreeWalker(sectionElement, NodeFilter.SHOW_TEXT, null, false);
                let node;
                const nodesToReplace = [];

                while (node = walker.nextNode()) {
                    if (node.textContent.toLowerCase().includes(keyword.toLowerCase())) {
                        nodesToReplace.push(node);
                    }
                }
                
                nodesToReplace.forEach(textNode => {
                    const parent = textNode.parentNode;
                    if (!parent || parent.nodeName === 'MARK') return; // 避免重复高亮
                    
                    const parts = textNode.textContent.split(regex);
                    const matches = textNode.textContent.match(regex);

                    if (!matches) return;

                    const fragment = document.createDocumentFragment();
                    parts.forEach((part, index) => {
                        fragment.appendChild(document.createTextNode(part));
                        if (index < matches.length) {
                            const mark = document.createElement('mark');
                            mark.className = 'temp-highlight';
                            mark.textContent = matches[index];
                            fragment.appendChild(mark);
                        }
                    });
                    parent.replaceChild(fragment, textNode);
                });
            }

            // --- 新增功能方法 ---
            _determineAndApplyInitialTheme() {
                const savedTheme = localStorage.getItem('theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                
                // 优先级: localStorage > 系统设置
                if (savedTheme) {
                    this._applyTheme(savedTheme);
                } else {
                    this._applyTheme(systemPrefersDark ? 'dark' : 'light');
                }
            }

            _applyTheme(theme) {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                // 不论来源如何，都将最终确定的主题存入localStorage
                localStorage.setItem('theme', theme);
                
                const isDark = theme === 'dark';
                document.getElementById('theme-icon-sun').classList.toggle('hidden', isDark);
                document.getElementById('theme-icon-moon').classList.toggle('hidden', !isDark);
            }

            _handleThemeToggle() {
                const currentIsDark = document.documentElement.classList.contains('dark');
                // 切换主题并保存到localStorage
                this._applyTheme(currentIsDark ? 'light' : 'dark');
            }

            _showFeedbackModal() {
                this.feedbackModal.classList.remove('hidden');
                setTimeout(() => {
                    this.feedbackModal.style.opacity = '1';
                    this.feedbackDialog.style.transform = 'scale(1)';
                    this.feedbackDialog.style.opacity = '1';
                }, 10);
            }

            _hideFeedbackModal() {
                this.feedbackModal.style.opacity = '0';
                this.feedbackDialog.style.transform = 'scale(0.95)';
                this.feedbackDialog.style.opacity = '0';
                setTimeout(() => {
                    this.feedbackModal.classList.add('hidden');
                    // 重置表单
                    this.feedbackForm.classList.remove('hidden');
                    this.feedbackSuccessMsg.classList.add('hidden');
                    this.feedbackForm.reset();
                }, 300);
            }

            _handleFeedbackSubmit(e) {
                e.preventDefault();
                const form = e.target;
                const formData = new FormData(form);

                // 使用 fetch 将数据异步提交到Netlify
                fetch("/", {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: new URLSearchParams(formData).toString()
                })
                .then(() => {
                    // 提交成功后显示成功信息
                    this.feedbackForm.classList.add('hidden');
                    this.feedbackSuccessMsg.classList.remove('hidden');
                    setTimeout(() => {
                        this._hideFeedbackModal();
                    }, 2000);
                })
                .catch((error) => {
                    // 处理错误情况
                    console.error(error);
                    const submitButton = form.querySelector('button[type="submit"]');
                    submitButton.textContent = '提交失败!';
                    submitButton.classList.add('bg-red-600');
                });
            }
        }

        // --- 应用入口点 ---
        document.addEventListener('DOMContentLoaded', () => {
            const app = new GuideApp(guideData, campusData);
            app.init();
        });
    </script>
</body>
</html>
```